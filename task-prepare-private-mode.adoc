---
sidebar: sidebar
permalink: task-prepare-private-mode.html
keywords: private mode requirements, requirements, install options, private mode networking, dark site, private mode permissions, permissions for private mode, networking for private mode
summary: Prepare your environment before you deploy BlueXP in private mode. For example, you need to review host requirements, prepare networking, set up permissions, and more.
---

= Prepare for deployment in private mode
:hardbreaks:
:nofooter:
:icons: font
:linkattrs:
:imagesdir: ./media/

[.lead]
Prepare your environment before you deploy BlueXP in private mode. For example, you need to review host requirements, prepare networking, set up permissions, and more.

NOTE: If you want to use BlueXP in the https://aws.amazon.com/federal/us-intelligence-community/[AWS Commercial Cloud Services (C2S) environment^] then you should follow separate instructions that describe how to prepare, install the Connector, and launch Cloud Volumes ONTAP. https://docs.netapp.com/us-en/bluexp-cloud-volumes-ontap/task-getting-started-aws-c2s.html[Learn how to get started with Cloud Volumes ONTAP in the AWS C2S environment^]

== Understand how private mode works

Before you get started, you should have an understanding of how BlueXP works in private mode. 

For example, you should understand that you need to use the browser-based interface that is available locally from the BlueXP Connector that you need to install. You can't access BlueXP from the web-based console that's provided through the SaaS layer.

In addition, not all BlueXP services are available.

link:concept-modes.html[Learn how private mode works].

== Review installation options

In private mode, you can install the Connector on premises or in the cloud by manually installing the Connector on your own Linux host.

If you want to create a Cloud Volumes ONTAP system in Google Cloud, then the Connector must be running in Google Cloud--it can't be running on premises.

== Review host requirements

The Connector software must run on a host that meets specific operating system requirements, RAM requirements, port requirements, and so on.

include::_include/os-reqs.adoc[tag=start]

include::_include/os-reqs.adoc[tag=aws-ec2]

include::_include/os-reqs.adoc[tag=azure-vm]

include::_include/os-reqs.adoc[tag=google-machine]

include::_include/os-reqs.adoc[tag=end]

== Prepare networking for the Connector

Set up your networking so the Connector can manage resources and processes within your public cloud environment. Other than having a virtual network and subnet for the Connector, you'll need to ensure that the following requirements are met.

=== Connections to target networks

The Connector must have a network connection to the location where you plan to manage storage. For example, the VPC or VNet where you plan to deploy Cloud Volumes ONTAP, or the data center where your on-premises ONTAP clusters reside.

=== Endpoints for day-to-day operations

The Connector contacts the following endpoints to manage resources and processes within your public cloud environment.

[cols="2a,1a",options="header,autowidth"]
|===
| Endpoints
| Purpose

include::_include/endpoints-connector.adoc[tag=aws-endpoints]

include::_include/endpoints-connector.adoc[tag=azure-public-endpoints]

include::_include/endpoints-connector.adoc[tag=azure-il6-endpoints]

include::_include/endpoints-connector.adoc[tag=azure-china-endpoints]

include::_include/endpoints-connector.adoc[tag=google-cloud-endpoints]

|===

=== Proxy server

include::_include/proxy-server.adoc[]

With private mode, the only time that BlueXP sends outbound traffic is to your cloud provider in order to create a Cloud Volumes ONTAP system.

=== Public IP address in Azure

include::_include/public-ip-azure.adoc[]

=== Ports

There's no incoming traffic to the Connector, unless you initiate it.

HTTP (80) and HTTPS (443) provide access to the BlueXP console. SSH (22) is only needed if you need to connect to the host for troubleshooting. 

== Prepare cloud permissions

If you are planning to create Cloud Volumes ONTAP systems, then BlueXP requires permissions from your cloud provider. You need to set up permissions in your cloud provider and then associate those permission with the Connector instance after you install it.

To view the required steps, select the authentication option that you'd like to use for your cloud provider. 

If you're going to install the Connector on premises, then you must provide permissions using AWS access keys or an Azure service principal. The other options are not supported.

// start tabbed area

[role="tabbed-block"]
====

.AWS IAM role
--
Use an IAM role to provide the Connector with permissions. You'll need to manually attach the role to the EC2 instance for the Connector.

.Steps

include::_include/aws-permissions.adoc[tag=policy]

include::_include/aws-permissions.adoc[tag=role]

.Result

You now have an IAM role for the Connector EC2 instance.
--

.AWS access key
--
Set up permissions and an access key for an IAM user. You'll need to provide BlueXP with the AWS access key after you install the Connector and set up BlueXP.

.Steps

include::_include/aws-permissions.adoc[tag=policy]
+
Depending on the BlueXP services that you're planning to use, you might need to create a second policy.
+
For standard regions, the permissions are spread across two policies. Two policies are required due to a maximum character size limit for managed policies in AWS. link:reference-permissions-aws.html[Learn more about IAM policies for the Connector].

include::_include/aws-permissions.adoc[tag=keys]

.Result

The account now has the required permissions.
--

.Azure role
--
Create an Azure custom role with the required permissions. You'll assign this role to the Connector VM.

.Steps

. Enable a system-assigned managed identity on the VM where you plan to install the Connector so that you can provide the required Azure permissions through a custom role.
+
https://learn.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/qs-configure-portal-windows-vm[Microsoft Azure documentation: Configure managed identities for Azure resources on a VM using the Azure portal^]

include::_include/azure-set-up-role.adoc[]
--

.Azure service principal
--
Create and set up a service principal in Azure Active Directory and obtain the Azure credentials that BlueXP needs. You'll need to provide BlueXP with these credentials after you install the Connector and set up BlueXP.

.Create an Azure Active Directory application for role-based access control

include::_include/azure-provide-permissions-role.adoc[create-azure-ad-app]

.Assign the application to a role

include::_include/azure-provide-permissions-role.adoc[create-and-assign-role]

.Add Windows Azure Service Management API permissions

include::_include/azure-provide-permissions-role.adoc[add-api-permissions]

.Get the application ID and directory ID for the application

include::_include/azure-provide-permissions-role.adoc[get-ids]

.Create a client secret

include::_include/azure-provide-permissions-role.adoc[create-secret]

.Result

Your service principal is now setup and you should have copied the application (client) ID, the directory (tenant) ID, and the value of the client secret. You need to enter this information in BlueXP when you add an Azure account.
--

.Google Cloud service account
--
include::_include/google-set-up-service-account.adoc[]
--

====
// end tabbed area

== Enable Google Cloud APIs

Several APIs are required to deploy Cloud Volumes ONTAP in Google Cloud.

.Step

. https://cloud.google.com/apis/docs/getting-started#enabling_apis[Enable the following Google Cloud APIs in your project^]
+
include::_include/google-cloud-apis.adoc[]